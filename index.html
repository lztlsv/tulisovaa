<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤: —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏ –æ–±—Ö–æ–¥ –¥–µ—Ä–µ–≤–∞</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #4a6fa5;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
        }
        
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .panel {
            flex: 1;
            min-width: 300px;
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        h2 {
            color: #3498db;
            margin-top: 0;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        h3 {
            color: #2c3e50;
            margin: 20px 0 10px 0;
            font-size: 16px;
        }
        
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
            align-items: center;
        }
        
        .tree-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }
        
        button, select, input {
            padding: 10px 15px;
            border-radius: 5px;
            border: 1px solid #ddd;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        button {
            background-color: #3498db;
            color: white;
            font-weight: bold;
        }
        
        button:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        
        button:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
            transform: none;
        }
        
        select, input {
            background-color: #f8f9fa;
        }
        
        .btn-small {
            padding: 6px 12px;
            font-size: 13px;
        }
        
        .btn-success {
            background-color: #2ecc71;
        }
        
        .btn-success:hover {
            background-color: #27ae60;
        }
        
        .btn-warning {
            background-color: #f39c12;
        }
        
        .btn-warning:hover {
            background-color: #d68910;
        }
        
        .btn-danger {
            background-color: #e74c3c;
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .control-label {
            font-size: 12px;
            color: #7f8c8d;
            font-weight: bold;
        }
        
        .size-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .size-value {
            min-width: 30px;
            text-align: center;
            font-weight: bold;
        }
        
        input[type="range"] {
            width: 100px;
            padding: 0;
        }
        
        .tree-editor, .array-editor {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .editor-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .node-input-group, .array-input-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .node-input, .array-input {
            width: 80px;
            text-align: center;
            padding: 8px;
        }
        
        .array-input-long {
            width: 200px;
            padding: 8px;
        }
        
        .instructions {
            background-color: #e8f4fc;
            padding: 12px;
            border-radius: 6px;
            font-size: 14px;
            margin-top: 15px;
            line-height: 1.5;
        }
        
        .instructions ol {
            margin: 8px 0;
            padding-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 5px;
        }
        
        .status-panel {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #2c3e50;
            color: white;
            padding: 10px 15px;
            border-radius: 6px;
            margin-top: 10px;
        }
        
        .status-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .status-label {
            font-size: 11px;
            opacity: 0.8;
        }
        
        .status-value {
            font-weight: bold;
            font-size: 16px;
        }
        
        .visualization {
            margin: 20px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
            min-height: 200px;
            position: relative;
            overflow: hidden;
        }
        
        .array-container {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            height: 180px;
            padding: 20px;
            gap: 8px;
        }
        
        .array-element {
            min-width: 30px;
            background-color: #3498db;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 5px 5px 0 0;
            font-weight: bold;
            position: relative;
            transition: all 0.3s;
            flex: 1;
            max-width: 60px;
        }
        
        .array-element.active {
            background-color: #e74c3c;
            transform: scale(1.1);
        }
        
        .array-element.compared {
            background-color: #f39c12;
        }
        
        .array-element.sorted {
            background-color: #2ecc71;
        }
        
        .array-value {
            position: absolute;
            top: -25px;
            font-size: 14px;
            font-weight: bold;
            white-space: nowrap;
        }
        
        .array-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        .tree-container {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 20px;
            min-height: 400px;
            width: 100%;
            overflow: auto;
            border: 1px dashed #ddd;
            border-radius: 8px;
            background-color: white;
        }
        
        .tree {
            position: relative;
            min-width: 600px;
            min-height: 400px;
            margin: 0 auto;
        }
        
        .tree-node {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #3498db;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            position: absolute;
            z-index: 2;
            transition: all 0.3s;
            border: 2px solid white;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
            cursor: pointer;
            font-size: 14px;
        }
        
        .tree-node:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        .tree-node.root {
            background-color: #9b59b6;
        }
        
        .tree-node.selected {
            background-color: #e74c3c;
            transform: scale(1.2);
            box-shadow: 0 0 0 4px rgba(231, 76, 60, 0.4);
            z-index: 3;
        }
        
        .tree-node.active {
            background-color: #e74c3c;
            transform: scale(1.2);
        }
        
        .tree-node.visited {
            background-color: #2ecc71;
        }
        
        .tree-line {
            position: absolute;
            background-color: #7f8c8d;
            height: 3px;
            transform-origin: 0 0;
            z-index: 1;
        }
        
        .info-panel {
            background-color: #e8f4fc;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-size: 15px;
            min-height: 80px;
        }
        
        .step-info {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 8px;
        }
        
        .complexity {
            margin-top: 15px;
            font-style: italic;
            color: #7f8c8d;
            font-size: 14px;
        }
        
        .code-snippet {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin-top: 15px;
        }
        
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            .tree {
                min-width: 400px;
            }
            .array-element {
                min-width: 25px;
                max-width: 40px;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</h1>
        <p class="subtitle">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –º–∞—Å—Å–∏–≤–∞ –∏ –æ–±—Ö–æ–¥–∞ –¥–µ—Ä–µ–≤–∞</p>
    </header>
    
    <div class="container">
        <!-- –ü–∞–Ω–µ–ª—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –º–∞—Å—Å–∏–≤–∞ -->
        <div class="panel">
            <h2>–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –º–∞—Å—Å–∏–≤–∞ (–ø—É–∑—ã—Ä—å–∫–æ–≤–∞—è)</h2>
            
            <div class="array-editor">
                <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞—Å—Å–∏–≤–æ–º</h3>
                
                <div class="editor-controls">
                    <div class="array-input-group">
                        <input type="number" id="singleNumber" class="array-input" placeholder="–ß–∏—Å–ª–æ" min="1" max="999" value="42">
                        <button id="addNumber" class="btn-small">–î–æ–±–∞–≤–∏—Ç—å —á–∏—Å–ª–æ</button>
                    </div>
                    
                    <div class="array-input-group">
                        <input type="text" id="multipleNumbers" class="array-input-long" placeholder="–ß–∏—Å–ª–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª (10 20 30)">
                        <button id="addMultiple" class="btn-small">–î–æ–±–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ</button>
                    </div>
                    
                    <div class="array-input-group">
                        <button id="clearArray" class="btn-small btn-danger">–û—á–∏—Å—Ç–∏—Ç—å –º–∞—Å—Å–∏–≤</button>
                        <button id="generateRandom" class="btn-small">–°–ª—É—á–∞–π–Ω—ã–π –º–∞—Å—Å–∏–≤</button>
                    </div>
                </div>
                
                <div class="controls">
                    <div class="control-group">
                        <div class="control-label">–†–ê–ó–ú–ï–† –ú–ê–°–°–ò–í–ê</div>
                        <div class="size-control">
                            <button id="decreaseSize">-</button>
                            <div class="size-value" id="arraySizeValue">8</div>
                            <button id="increaseSize">+</button>
                            <input type="range" id="arraySizeSlider" min="3" max="20" value="8" step="1">
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <div class="control-label">–°–ö–û–†–û–°–¢–¨</div>
                        <select id="speedSort">
                            <option value="800">–û—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ</option>
                            <option value="500">–ú–µ–¥–ª–µ–Ω–Ω–æ</option>
                            <option value="300" selected>–°—Ä–µ–¥–Ω–µ</option>
                            <option value="100">–ë—ã—Å—Ç—Ä–æ</option>
                            <option value="50">–û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ</option>
                        </select>
                    </div>
                </div>
                
                <div class="instructions">
                    <strong>–ö–∞–∫ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –º–∞—Å—Å–∏–≤:</strong>
                    <ol>
                        <li>–í–≤–µ–¥–∏—Ç–µ –æ–¥–Ω–æ —á–∏—Å–ª–æ –∏ –Ω–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å —á–∏—Å–ª–æ"</li>
                        <li>–ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∏—Å–µ–ª —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª –∏ –Ω–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ"</li>
                        <li>–ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ä–∞–∑–º–µ—Ä –∏ –Ω–∞–∂–º–∏—Ç–µ "–°–ª—É—á–∞–π–Ω—ã–π –º–∞—Å—Å–∏–≤"</li>
                        <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ "–û—á–∏—Å—Ç–∏—Ç—å –º–∞—Å—Å–∏–≤" —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</li>
                    </ol>
                    <div style="margin-top: 10px;">
                        <strong>–¢–µ–∫—É—â–∏–π –º–∞—Å—Å–∏–≤:</strong> [<span id="currentArrayValues"></span>]
                    </div>
                </div>
                
                <div class="status-panel">
                    <div class="status-item">
                        <div class="status-label">–†–ê–ó–ú–ï–†</div>
                        <div class="status-value" id="currentSize">0</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">–ú–ò–ù–ò–ú–£–ú</div>
                        <div class="status-value" id="arrayMin">-</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">–ú–ê–ö–°–ò–ú–£–ú</div>
                        <div class="status-value" id="arrayMax">-</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">–°–£–ú–ú–ê</div>
                        <div class="status-value" id="arraySum">0</div>
                    </div>
                </div>
            </div>
            
            <div class="controls">
                <button id="startSort">‚ñ∂ –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É</button>
                <button id="nextStepSort">‚è≠ –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥</button>
                <button id="resetSort">‚Üª –°–±—Ä–æ—Å–∏—Ç—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É</button>
            </div>
            
            <div class="visualization">
                <div id="arrayVisualization" class="array-container">
                    <!-- –ú–∞—Å—Å–∏–≤ –±—É–¥–µ—Ç –æ—Ç—Ä–∏—Å–æ–≤–∞–Ω –∑–¥–µ—Å—å -->
                </div>
            </div>
            
            <div class="info-panel">
                <div id="sortInfo" class="step-info">–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–∞ –≤ –º–∞—Å—Å–∏–≤ –∏–ª–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å–ª—É—á–∞–π–Ω—ã–π</div>
                <div>–°—Ä–∞–≤–Ω–µ–Ω–∏—è: <span id="comparisons">0</span>, –ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏: <span id="swaps">0</span></div>
                <div class="complexity">–°–ª–æ–∂–Ω–æ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–∞: O(n¬≤) –≤ —Ö—É–¥—à–µ–º —Å–ª—É—á–∞–µ, –≥–¥–µ n = —Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞</div>
            </div>
            
            <div class="code-snippet">
// –ê–ª–≥–æ—Ä–∏—Ç–º –ø—É–∑—ã—Ä—å–∫–æ–≤–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏:
for (i = 0; i < n-1; i++) {
    for (j = 0; j < n-i-1; j++) {
        if (array[j] > array[j+1]) {
            swap(array[j], array[j+1]); // –ú–µ–Ω—è–µ–º –º–µ—Å—Ç–∞–º–∏
        }
    }
}
            </div>
        </div>
        
        <!-- –ü–∞–Ω–µ–ª—å –æ–±—Ö–æ–¥–∞ –¥–µ—Ä–µ–≤–∞ -->
        <div class="panel">
            <h2>–û–±—Ö–æ–¥ –¥–µ—Ä–µ–≤–∞ (–≤ –≥–ª—É–±–∏–Ω—É - DFS)</h2>
            
            <div class="tree-controls">
                <div class="tree-editor">
                    <h3>–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –¥–µ—Ä–µ–≤–∞</h3>
                    
                    <div class="editor-controls">
                        <div class="node-input-group">
                            <input type="number" id="nodeValue" class="node-input" placeholder="–ó–Ω–∞—á–µ–Ω–∏–µ" min="1" max="99" value="50">
                            <button id="addRoot" class="btn-small">–°–æ–∑–¥–∞—Ç—å –∫–æ—Ä–µ–Ω—å</button>
                        </div>
                        
                        <div class="node-input-group">
                            <input type="number" id="childValue" class="node-input" placeholder="–ó–Ω–∞—á–µ–Ω–∏–µ" min="1" max="99" value="30">
                            <button id="addLeftChild" class="btn-small" disabled>–î–æ–±–∞–≤–∏—Ç—å –ª–µ–≤–æ–≥–æ</button>
                            <button id="addRightChild" class="btn-small" disabled>–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–æ–≥–æ</button>
                        </div>
                        
                        <div class="node-input-group">
                            <button id="removeNode" class="btn-small btn-danger" disabled>–£–¥–∞–ª–∏—Ç—å —É–∑–µ–ª</button>
                            <button id="clearTree" class="btn-small btn-danger">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ</button>
                            <button id="randomTree" class="btn-small">–°–ª—É—á–∞–π–Ω–æ–µ –¥–µ—Ä–µ–≤–æ</button>
                        </div>
                    </div>
                    
                    <div class="instructions">
                        <strong>–ö–∞–∫ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –¥–µ—Ä–µ–≤–æ:</strong>
                        <ol>
                            <li>–í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ (1-99) –∏ –Ω–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å –∫–æ—Ä–µ–Ω—å"</li>
                            <li>–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ —É–∑–µ–ª, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å –µ–≥–æ (–æ–Ω —Å—Ç–∞–Ω–µ—Ç –∫—Ä–∞—Å–Ω—ã–º)</li>
                            <li>–í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –Ω–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –ª–µ–≤–æ–≥–æ" –∏–ª–∏ "–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–æ–≥–æ"</li>
                            <li>–ü–æ–≤—Ç–æ—Ä—è–π—Ç–µ —à–∞–≥–∏ 2-3 –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ª—é–±–æ–≥–æ –¥–µ—Ä–µ–≤–∞</li>
                            <li>–£–¥–∞–ª—è–π—Ç–µ —É–∑–ª—ã –∫–Ω–æ–ø–∫–æ–π "–£–¥–∞–ª–∏—Ç—å —É–∑–µ–ª"</li>
                        </ol>
                    </div>
                    
                    <div class="status-panel">
                        <div class="status-item">
                            <div class="status-label">–í–´–ë–†–ê–ù–ù–´–ô –£–ó–ï–õ</div>
                            <div class="status-value" id="selectedNodeValue">-</div>
                        </div>
                        <div class="status-item">
                            <div class="status-label">–í–°–ï–ì–û –£–ó–õ–û–í</div>
                            <div class="status-value" id="totalNodes">0</div>
                        </div>
                        <div class="status-item">
                            <div class="status-label">–ì–õ–£–ë–ò–ù–ê</div>
                            <div class="status-value" id="treeDepth">0</div>
                        </div>
                    </div>
                </div>
                
                <div class="controls">
                    <button id="startTraversal">‚ñ∂ –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—Ö–æ–¥</button>
                    <button id="nextStepTraversal">‚è≠ –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥</button>
                    <button id="resetTraversal">‚Üª –°–±—Ä–æ—Å–∏—Ç—å –æ–±—Ö–æ–¥</button>
                    
                    <select id="traversalType">
                        <option value="preorder">–ü—Ä—è–º–æ–π –æ–±—Ö–æ–¥ (Pre-order)</option>
                        <option value="inorder">–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –æ–±—Ö–æ–¥ (In-order)</option>
                        <option value="postorder">–û–±—Ä–∞—Ç–Ω—ã–π –æ–±—Ö–æ–¥ (Post-order)</option>
                    </select>
                    
                    <div class="control-group">
                        <div class="control-label">–°–ö–û–†–û–°–¢–¨ –û–ë–•–û–î–ê</div>
                        <select id="speedTraversal">
                            <option value="1000">–ú–µ–¥–ª–µ–Ω–Ω–æ</option>
                            <option value="600" selected>–°—Ä–µ–¥–Ω–µ</option>
                            <option value="300">–ë—ã—Å—Ç—Ä–æ</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="visualization">
                <div id="treeVisualization" class="tree-container">
                    <!-- –î–µ—Ä–µ–≤–æ –±—É–¥–µ—Ç –æ—Ç—Ä–∏—Å–æ–≤–∞–Ω–æ –∑–¥–µ—Å—å -->
                </div>
            </div>
            
            <div class="info-panel">
                <div id="traversalInfo" class="step-info">–°–æ–∑–¥–∞–π—Ç–µ –¥–µ—Ä–µ–≤–æ –∏–ª–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å–ª—É—á–∞–π–Ω–æ–µ</div>
                <div>–ü–æ—Ä—è–¥–æ–∫ –æ–±—Ö–æ–¥–∞: <span id="traversalOrder" style="font-weight: bold; color: #2c3e50;"></span></div>
                <div>–ü–æ—Å–µ—â–µ–Ω–æ —É–∑–ª–æ–≤: <span id="visitedNodes">0</span> –∏–∑ <span id="totalNodesInfo">0</span></div>
                <div class="complexity">–°–ª–æ–∂–Ω–æ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–∞ DFS: O(n) –≤—Ä–µ–º–µ–Ω–∏ –∏ O(h) –ø–∞–º—è—Ç–∏, –≥–¥–µ n = —É–∑–ª—ã, h = –≤—ã—Å–æ—Ç–∞</div>
            </div>
            
            <div class="code-snippet">
// –ê–ª–≥–æ—Ä–∏—Ç–º –æ–±—Ö–æ–¥–∞ –¥–µ—Ä–µ–≤–∞ –≤ –≥–ª—É–±–∏–Ω—É (Pre-order):
function dfs(node) {
    if (node == null) return;
    visit(node);           // –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —É–∑–µ–ª
    dfs(node.left);        // –û–±–æ–π—Ç–∏ –ª–µ–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ
    dfs(node.right);       // –û–±–æ–π—Ç–∏ –ø—Ä–∞–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ
}

// In-order: left ‚Üí node ‚Üí right
// Post-order: left ‚Üí right ‚Üí node
            </div>
        </div>
    </div>
    
    <script>
        // ========== –ú–û–î–ï–õ–¨ –°–û–†–¢–ò–†–û–í–ö–ò –ú–ê–°–°–ò–í–ê ==========
        let array = [];
        let arrayState = {
            sorted: false,
            currentStep: 0,
            i: 0,
            j: 0,
            comparisons: 0,
            swaps: 0,
            totalSteps: 0,
            isRunning: false,
            intervalId: null
        };
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –º–∞—Å—Å–∏–≤–∞
        let arraySize = 8;
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM –¥–ª—è –º–∞—Å—Å–∏–≤–∞
        const arrayVisualization = document.getElementById('arrayVisualization');
        const sortInfo = document.getElementById('sortInfo');
        const comparisonsElement = document.getElementById('comparisons');
        const swapsElement = document.getElementById('swaps');
        const currentSizeElement = document.getElementById('currentSize');
        const arraySizeValue = document.getElementById('arraySizeValue');
        const arraySizeSlider = document.getElementById('arraySizeSlider');
        const currentArrayValues = document.getElementById('currentArrayValues');
        const arrayMinElement = document.getElementById('arrayMin');
        const arrayMaxElement = document.getElementById('arrayMax');
        const arraySumElement = document.getElementById('arraySum');
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∞—Å—Å–∏–≤–æ–º
        const singleNumberInput = document.getElementById('singleNumber');
        const multipleNumbersInput = document.getElementById('multipleNumbers');
        const addNumberBtn = document.getElementById('addNumber');
        const addMultipleBtn = document.getElementById('addMultiple');
        const clearArrayBtn = document.getElementById('clearArray');
        const generateRandomBtn = document.getElementById('generateRandom');
        const decreaseSizeBtn = document.getElementById('decreaseSize');
        const increaseSizeBtn = document.getElementById('increaseSize');
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –º–∞—Å—Å–∏–≤–∞
        function updateArrayStats() {
            const size = array.length;
            currentSizeElement.textContent = size;
            currentArrayValues.textContent = array.join(', ');
            
            if (size > 0) {
                const min = Math.min(...array);
                const max = Math.max(...array);
                const sum = array.reduce((a, b) => a + b, 0);
                
                arrayMinElement.textContent = min;
                arrayMaxElement.textContent = max;
                arraySumElement.textContent = sum;
            } else {
                arrayMinElement.textContent = '-';
                arrayMaxElement.textContent = '-';
                arraySumElement.textContent = '0';
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ —á–∏—Å–ª–∞
        function addSingleNumber() {
            const value = parseInt(singleNumberInput.value);
            if (isNaN(value) || value < 1 || value > 999) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 999');
                singleNumberInput.focus();
                return;
            }
            
            // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –º–∞—Å—Å–∏–≤–∞
            resetSortingState();
            
            array.push(value);
            updateArrayStats();
            renderArray();
            
            sortInfo.textContent = `–î–æ–±–∞–≤–ª–µ–Ω–æ —á–∏—Å–ª–æ ${value}. –ú–∞—Å—Å–∏–≤: [${array.join(', ')}]`;
            sortInfo.style.color = '#3498db';
            
            // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—è –≤–≤–æ–¥–∞
            singleNumberInput.value = '';
            singleNumberInput.focus();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —á–∏—Å–µ–ª
        function addMultipleNumbers() {
            const input = multipleNumbersInput.value.trim();
            if (!input) {
                alert('–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª');
                multipleNumbersInput.focus();
                return;
            }
            
            // –†–∞–∑–±–∏–≤–∞–µ–º —Å—Ç—Ä–æ–∫—É –Ω–∞ —á–∏—Å–ª–∞
            const numbers = input.split(/\s+/).map(num => parseInt(num));
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ —á–∏—Å–ª–∞
            for (let num of numbers) {
                if (isNaN(num) || num < 1 || num > 999) {
                    alert(`–ß–∏—Å–ª–æ "${num}" –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–æ. –í–≤–æ–¥–∏—Ç–µ —á–∏—Å–ª–∞ –æ—Ç 1 –¥–æ 999 —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª`);
                    multipleNumbersInput.focus();
                    return;
                }
            }
            
            // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –º–∞—Å—Å–∏–≤–∞
            resetSortingState();
            
            array.push(...numbers);
            updateArrayStats();
            renderArray();
            
            sortInfo.textContent = `–î–æ–±–∞–≤–ª–µ–Ω–æ ${numbers.length} —á–∏—Å–µ–ª. –ú–∞—Å—Å–∏–≤: [${array.join(', ')}]`;
            sortInfo.style.color = '#3498db';
            
            // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—è –≤–≤–æ–¥–∞
            multipleNumbersInput.value = '';
            multipleNumbersInput.focus();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –º–∞—Å—Å–∏–≤–∞
        function clearArray() {
            if (array.length === 0) {
                sortInfo.textContent = '–ú–∞—Å—Å–∏–≤ —É–∂–µ –ø—É—Å—Ç';
                sortInfo.style.color = '#7f8c8d';
                return;
            }
            
            if (confirm(`–û—á–∏—Å—Ç–∏—Ç—å –º–∞—Å—Å–∏–≤ –∏–∑ ${array.length} —ç–ª–µ–º–µ–Ω—Ç–æ–≤?`)) {
                array = [];
                resetSortingState();
                updateArrayStats();
                renderArray();
                
                sortInfo.textContent = '–ú–∞—Å—Å–∏–≤ –æ—á–∏—â–µ–Ω. –í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–µ —á–∏—Å–ª–∞';
                sortInfo.style.color = '#e74c3c';
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞
        function generateRandomArray() {
            resetSortingState();
            array = [];
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏
            let usedValues = new Set();
            for (let i = 0; i < arraySize; i++) {
                let value;
                do {
                    value = Math.floor(Math.random() * 90) + 10; // –ß–∏—Å–ª–∞ –æ—Ç 10 –¥–æ 100
                } while (usedValues.has(value) && usedValues.size < 80);
                usedValues.add(value);
                array.push(value);
            }
            
            updateArrayStats();
            renderArray();
            
            sortInfo.textContent = `–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —Å–ª—É—á–∞–π–Ω—ã–π –º–∞—Å—Å–∏–≤ –∏–∑ ${arraySize} —ç–ª–µ–º–µ–Ω—Ç–æ–≤`;
            sortInfo.style.color = '#9b59b6';
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –º–∞—Å—Å–∏–≤–∞
        function updateArraySize(newSize) {
            arraySize = Math.max(3, Math.min(20, newSize)); // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –æ—Ç 3 –¥–æ 20
            arraySizeValue.textContent = arraySize;
            arraySizeSlider.value = arraySize;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–∞–∑–º–µ—Ä–µ
            currentSizeElement.textContent = array.length;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–±—Ä–æ—Å–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ (–±–µ–∑ —Å–±—Ä–æ—Å–∞ –º–∞—Å—Å–∏–≤–∞)
        function resetSortingState() {
            stopSorting();
            arrayState = {
                sorted: false,
                currentStep: 0,
                i: 0,
                j: 0,
                comparisons: 0,
                swaps: 0,
                totalSteps: 0,
                isRunning: false,
                intervalId: null
            };
            comparisonsElement.textContent = '0';
            swapsElement.textContent = '0';
        }
        
        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –º–∞—Å—Å–∏–≤–∞
        function renderArray() {
            arrayVisualization.innerHTML = '';
            
            if (array.length === 0) {
                const emptyMessage = document.createElement('div');
                emptyMessage.style.textAlign = 'center';
                emptyMessage.style.padding = '50px';
                emptyMessage.style.color = '#7f8c8d';
                emptyMessage.innerHTML = `
                    <div style="font-size: 48px; margin-bottom: 20px;">üìä</div>
                    <h3 style="margin-bottom: 10px;">–ú–∞—Å—Å–∏–≤ –ø—É—Å—Ç</h3>
                    <p>–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–∞ —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É</p>
                `;
                arrayVisualization.appendChild(emptyMessage);
                return;
            }
            
            const maxValue = Math.max(...array);
            const containerWidth = arrayVisualization.clientWidth;
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —à–∏—Ä–∏–Ω—É —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            const maxElementWidth = Math.min(60, (containerWidth - (array.length * 8)) / array.length);
            
            array.forEach((value, index) => {
                const element = document.createElement('div');
                element.className = 'array-element';
                
                // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –≤—ã—Å–æ—Ç—É —ç–ª–µ–º–µ–Ω—Ç–∞
                const heightPercentage = (value / maxValue) * 0.8 + 0.2; // –û—Ç 20% –¥–æ 100%
                element.style.height = `${heightPercentage * 120}px`;
                element.style.width = `${maxElementWidth}px`;
                
                // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                if (arrayState.sorted) {
                    element.classList.add('sorted');
                } else if (index === arrayState.j && arrayState.isRunning) {
                    element.classList.add('active');
                } else if (index === arrayState.j + 1 && arrayState.isRunning) {
                    element.classList.add('compared');
                }
                
                const valueLabel = document.createElement('div');
                valueLabel.className = 'array-value';
                valueLabel.textContent = value;
                
                element.appendChild(valueLabel);
                arrayVisualization.appendChild(element);
            });
        }
        
        // –û–¥–∏–Ω —à–∞–≥ –ø—É–∑—ã—Ä—å–∫–æ–≤–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
        function bubbleSortStep() {
            if (arrayState.sorted) {
                sortInfo.textContent = '‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!';
                sortInfo.style.color = '#2ecc71';
                stopSorting();
                return;
            }
            
            const n = array.length;
            
            // –í–Ω–µ—à–Ω–∏–π —Ü–∏–∫–ª
            if (arrayState.i < n - 1) {
                // –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ü–∏–∫–ª
                if (arrayState.j < n - arrayState.i - 1) {
                    // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                    arrayState.comparisons++;
                    comparisonsElement.textContent = arrayState.comparisons;
                    
                    sortInfo.textContent = `–°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã [${arrayState.j}] = ${array[arrayState.j]} –∏ [${arrayState.j+1}] = ${array[arrayState.j+1]}`;
                    sortInfo.style.color = '#3498db';
                    
                    // –ï—Å–ª–∏ —Ç–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç –±–æ–ª—å—à–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ
                    if (array[arrayState.j] > array[arrayState.j + 1]) {
                        // –ú–µ–Ω—è–µ–º –º–µ—Å—Ç–∞–º–∏
                        [array[arrayState.j], array[arrayState.j + 1]] = [array[arrayState.j + 1], array[arrayState.j]];
                        arrayState.swaps++;
                        swapsElement.textContent = arrayState.swaps;
                        sortInfo.textContent += ` ‚Üí –ú–µ–Ω—è–µ–º –º–µ—Å—Ç–∞–º–∏!`;
                        sortInfo.style.color = '#f39c12';
                    }
                    
                    arrayState.j++;
                    arrayState.totalSteps++;
                } else {
                    // –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –≤–Ω–µ—à–Ω–µ–≥–æ —Ü–∏–∫–ª–∞
                    arrayState.i++;
                    arrayState.j = 0;
                    sortInfo.textContent = `–ó–∞–≤–µ—Ä—à–∏–ª–∏ –ø—Ä–æ—Ö–æ–¥ ${arrayState.i}. –ù–∞—á–∏–Ω–∞–µ–º –ø—Ä–æ—Ö–æ–¥ ${arrayState.i + 1}`;
                    sortInfo.style.color = '#9b59b6';
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
                    if (arrayState.i >= n - 1) {
                        arrayState.sorted = true;
                        sortInfo.textContent = '‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –ú–∞—Å—Å–∏–≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω.';
                        sortInfo.style.color = '#2ecc71';
                    }
                }
            }
            
            renderArray();
            updateArrayStats();
        }
        
        // –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
        function startSorting() {
            if (array.length === 0) {
                alert('–°–Ω–∞—á–∞–ª–∞ –¥–æ–±–∞–≤—å—Ç–µ —á–∏—Å–ª–∞ –≤ –º–∞—Å—Å–∏–≤');
                return;
            }
            
            if (arrayState.isRunning || arrayState.sorted) return;
            
            arrayState.isRunning = true;
            const speed = parseInt(document.getElementById('speedSort').value);
            
            arrayState.intervalId = setInterval(() => {
                bubbleSortStep();
            }, speed);
            
            sortInfo.textContent = 'üöÄ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∑–∞–ø—É—â–µ–Ω–∞...';
            sortInfo.style.color = '#9b59b6';
        }
        
        // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
        function stopSorting() {
            if (arrayState.intervalId) {
                clearInterval(arrayState.intervalId);
                arrayState.intervalId = null;
            }
            arrayState.isRunning = false;
        }
        
        // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ (–ø–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å)
        function resetSorting() {
            stopSorting();
            resetSortingState();
            
            if (array.length > 0) {
                renderArray();
                sortInfo.textContent = '–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å–±—Ä–æ—à–µ–Ω–∞. –ú–∞—Å—Å–∏–≤ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ';
                sortInfo.style.color = '#7f8c8d';
            } else {
                sortInfo.textContent = '–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–∞ –≤ –º–∞—Å—Å–∏–≤ —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É';
                sortInfo.style.color = '#7f8c8d';
            }
        }
        
        // ========== –ú–û–î–ï–õ–¨ –î–ï–†–ï–í–ê –° –†–£–ß–ù–´–ú –ü–û–°–¢–†–û–ï–ù–ò–ï–ú ==========
        class TreeNode {
            constructor(value, x, y, level, id) {
                this.value = value;
                this.left = null;
                this.right = null;
                this.x = x;
                this.y = y;
                this.level = level;
                this.id = id;
                this.parent = null;
                this.selected = false;
            }
        }
        
        let tree = null;
        let selectedNode = null;
        let nodeCounter = 0;
        let traversalState = {
            visited: [],
            order: [],
            currentStep: 0,
            isRunning: false,
            intervalId: null,
            traversalStack: []
        };
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM –¥–ª—è –¥–µ—Ä–µ–≤–∞
        const treeVisualization = document.getElementById('treeVisualization');
        const traversalInfo = document.getElementById('traversalInfo');
        const traversalOrderElement = document.getElementById('traversalOrder');
        const selectedNodeValue = document.getElementById('selectedNodeValue');
        const totalNodesElement = document.getElementById('totalNodes');
        const treeDepthElement = document.getElementById('treeDepth');
        const visitedNodesElement = document.getElementById('visitedNodes');
        const totalNodesInfoElement = document.getElementById('totalNodesInfo');
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–µ—Ä–µ–≤–æ–º
        const nodeValueInput = document.getElementById('nodeValue');
        const childValueInput = document.getElementById('childValue');
        const addRootBtn = document.getElementById('addRoot');
        const addLeftChildBtn = document.getElementById('addLeftChild');
        const addRightChildBtn = document.getElementById('addRightChild');
        const removeNodeBtn = document.getElementById('removeNode');
        const clearTreeBtn = document.getElementById('clearTree');
        const randomTreeBtn = document.getElementById('randomTree');
        const speedTraversalSelect = document.getElementById('speedTraversal');
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ —É–∑–ª–æ–≤ –≤ –¥–µ—Ä–µ–≤–µ
        function countNodes(node) {
            if (!node) return 0;
            return 1 + countNodes(node.left) + countNodes(node.right);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≥–ª—É–±–∏–Ω—ã –¥–µ—Ä–µ–≤–∞
        function calculateTreeDepth(node) {
            if (!node) return 0;
            return 1 + Math.max(calculateTreeDepth(node.left), calculateTreeDepth(node.right));
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–µ—Ä–µ–≤–∞
        function updateTreeStats() {
            const nodeCount = tree ? countNodes(tree) : 0;
            const depth = tree ? calculateTreeDepth(tree) : 0;
            
            totalNodesElement.textContent = nodeCount;
            treeDepthElement.textContent = depth;
            totalNodesInfoElement.textContent = nodeCount;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
            updateButtonStates();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–æ–∫
        function updateButtonStates() {
            const hasTree = tree !== null;
            const hasSelection = selectedNode !== null;
            
            // –ö–Ω–æ–ø–∫–∏, —Ç—Ä–µ–±—É—é—â–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —É–∑–ª–∞
            addLeftChildBtn.disabled = !hasSelection;
            addRightChildBtn.disabled = !hasSelection;
            removeNodeBtn.disabled = !hasSelection;
            
            // –ö–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ—Ä–Ω—è –≤—Å–µ–≥–¥–∞ –∞–∫—Ç–∏–≤–Ω–∞
            addRootBtn.disabled = false;
            
            // –ï—Å–ª–∏ —É –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —É–∑–ª–∞ —É–∂–µ –µ—Å—Ç—å –ª–µ–≤—ã–π –ø–æ—Ç–æ–º–æ–∫
            if (selectedNode && selectedNode.left) {
                addLeftChildBtn.disabled = true;
                addLeftChildBtn.title = '–õ–µ–≤—ã–π –ø–æ—Ç–æ–º–æ–∫ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç';
            } else if (selectedNode) {
                addLeftChildBtn.title = '–î–æ–±–∞–≤–∏—Ç—å –ª–µ–≤–æ–≥–æ –ø–æ—Ç–æ–º–∫–∞';
            }
            
            // –ï—Å–ª–∏ —É –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —É–∑–ª–∞ —É–∂–µ –µ—Å—Ç—å –ø—Ä–∞–≤—ã–π –ø–æ—Ç–æ–º–æ–∫
            if (selectedNode && selectedNode.right) {
                addRightChildBtn.disabled = true;
                addRightChildBtn.title = '–ü—Ä–∞–≤—ã–π –ø–æ—Ç–æ–º–æ–∫ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç';
            } else if (selectedNode) {
                addRightChildBtn.title = '–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–æ–≥–æ –ø–æ—Ç–æ–º–∫–∞';
            }
            
            // –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω –∫–æ—Ä–µ–Ω—å
            if (selectedNode && selectedNode === tree) {
                removeNodeBtn.title = '–£–¥–∞–ª–µ–Ω–∏–µ –∫–æ—Ä–Ω—è —É–¥–∞–ª–∏—Ç –≤—Å—ë –¥–µ—Ä–µ–≤–æ';
            } else if (selectedNode) {
                removeNodeBtn.title = '–£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π —É–∑–µ–ª';
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–±–æ—Ä–∞ —É–∑–ª–∞
        function selectNode(node) {
            // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —É–∑–ª–∞
            if (selectedNode) {
                selectedNode.selected = false;
            }
            
            // –í—ã–±–∏—Ä–∞–µ–º –Ω–æ–≤—ã–π —É–∑–µ–ª
            selectedNode = node;
            if (node) {
                node.selected = true;
                selectedNodeValue.textContent = node.value;
                selectedNodeValue.style.color = '#e74c3c';
            } else {
                selectedNodeValue.textContent = '-';
                selectedNodeValue.style.color = '#fff';
            }
            
            updateButtonStates();
            renderTree();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ—Ä–Ω—è
        function addRoot() {
            const value = parseInt(nodeValueInput.value);
            if (isNaN(value) || value < 1 || value > 99) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç 1 –¥–æ 99');
                nodeValueInput.focus();
                return;
            }
            
            const containerWidth = treeVisualization.clientWidth;
            
            nodeCounter++;
            tree = new TreeNode(value, containerWidth / 2, 80, 1, nodeCounter);
            selectNode(tree);
            updateTreeStats();
            renderTree();
            
            traversalInfo.textContent = `–°–æ–∑–¥–∞–Ω –∫–æ—Ä–µ–Ω—å –¥–µ—Ä–µ–≤–∞ —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º ${value}. –í—ã–±–µ—Ä–∏—Ç–µ —É–∑–µ–ª –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ç–æ–º–∫–æ–≤.`;
            traversalInfo.style.color = '#2ecc71';
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ª–µ–≤–æ–≥–æ –ø–æ—Ç–æ–º–∫–∞
        function addLeftChild() {
            if (!selectedNode) {
                alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —É–∑–µ–ª, –∫–ª–∏–∫–Ω—É–≤ –ø–æ –Ω–µ–º—É');
                return;
            }
            
            if (selectedNode.left) {
                alert('–£ —ç—Ç–æ–≥–æ —É–∑–ª–∞ —É–∂–µ –µ—Å—Ç—å –ª–µ–≤—ã–π –ø–æ—Ç–æ–º–æ–∫');
                return;
            }
            
            const value = parseInt(childValueInput.value);
            if (isNaN(value) || value < 1 || value > 99) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç 1 –¥–æ 99');
                childValueInput.focus();
                return;
            }
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–º–µ—â–µ–Ω–∏–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Ä–æ–≤–Ω—è
            const xOffset = 180 / Math.pow(1.4, selectedNode.level);
            nodeCounter++;
            
            selectedNode.left = new TreeNode(
                value,
                selectedNode.x - xOffset,
                selectedNode.y + 100,
                selectedNode.level + 1,
                nodeCounter
            );
            selectedNode.left.parent = selectedNode;
            
            updateTreeStats();
            renderTree();
            
            traversalInfo.textContent = `–î–æ–±–∞–≤–ª–µ–Ω –ª–µ–≤—ã–π –ø–æ—Ç–æ–º–æ–∫ ${value} –∫ —É–∑–ª—É ${selectedNode.value}`;
            traversalInfo.style.color = '#3498db';
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∞–≤–æ–≥–æ –ø–æ—Ç–æ–º–∫–∞
        function addRightChild() {
            if (!selectedNode) {
                alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —É–∑–µ–ª, –∫–ª–∏–∫–Ω—É–≤ –ø–æ –Ω–µ–º—É');
                return;
            }
            
            if (selectedNode.right) {
                alert('–£ —ç—Ç–æ–≥–æ —É–∑–ª–∞ —É–∂–µ –µ—Å—Ç—å –ø—Ä–∞–≤—ã–π –ø–æ—Ç–æ–º–æ–∫');
                return;
            }
            
            const value = parseInt(childValueInput.value);
            if (isNaN(value) || value < 1 || value > 99) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç 1 –¥–æ 99');
                childValueInput.focus();
                return;
            }
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–º–µ—â–µ–Ω–∏–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Ä–æ–≤–Ω—è
            const xOffset = 180 / Math.pow(1.4, selectedNode.level);
            nodeCounter++;
            
            selectedNode.right = new TreeNode(
                value,
                selectedNode.x + xOffset,
                selectedNode.y + 100,
                selectedNode.level + 1,
                nodeCounter
            );
            selectedNode.right.parent = selectedNode;
            
            updateTreeStats();
            renderTree();
            
            traversalInfo.textContent = `–î–æ–±–∞–≤–ª–µ–Ω –ø—Ä–∞–≤—ã–π –ø–æ—Ç–æ–º–æ–∫ ${value} –∫ —É–∑–ª—É ${selectedNode.value}`;
            traversalInfo.style.color = '#3498db';
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —É–∑–ª–∞
        function removeNode() {
            if (!selectedNode) {
                alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —É–∑–µ–ª –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è');
                return;
            }
            
            if (selectedNode === tree) {
                // –ï—Å–ª–∏ —É–¥–∞–ª—è–µ–º –∫–æ—Ä–µ–Ω—å, –æ—á–∏—â–∞–µ–º –≤—Å–µ –¥–µ—Ä–µ–≤–æ
                if (confirm('–£–¥–∞–ª–µ–Ω–∏–µ –∫–æ—Ä–Ω—è —É–¥–∞–ª–∏—Ç –≤—Å—ë –¥–µ—Ä–µ–≤–æ. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
                    clearTree();
                }
                return;
            }
            
            // –ù–∞—Ö–æ–¥–∏–º —Ä–æ–¥–∏—Ç–µ–ª—è –∏ —É–¥–∞–ª—è–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ —ç—Ç–æ—Ç —É–∑–µ–ª
            if (selectedNode.parent) {
                if (selectedNode.parent.left === selectedNode) {
                    selectedNode.parent.left = null;
                } else if (selectedNode.parent.right === selectedNode) {
                    selectedNode.parent.right = null;
                }
            }
            
            // –í—ã–±–∏—Ä–∞–µ–º —Ä–æ–¥–∏—Ç–µ–ª—è –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è
            const parent = selectedNode.parent;
            selectNode(parent);
            
            updateTreeStats();
            renderTree();
            
            traversalInfo.textContent = '–£–∑–µ–ª —É–¥–∞–ª–µ–Ω';
            traversalInfo.style.color = '#e74c3c';
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –¥–µ—Ä–µ–≤–∞
        function clearTree() {
            tree = null;
            selectedNode = null;
            nodeCounter = 0;
            resetTraversal();
            updateTreeStats();
            renderTree();
            
            traversalInfo.textContent = '–î–µ—Ä–µ–≤–æ –æ—á–∏—â–µ–Ω–æ. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –¥–µ—Ä–µ–≤–æ';
            traversalInfo.style.color = '#7f8c8d';
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞
        function generateRandomTree() {
            clearTree();
            
            // –ü–æ–ª—É—á–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
            const containerWidth = treeVisualization.clientWidth;
            
            // –°–æ–∑–¥–∞–µ–º –∫–æ—Ä–µ–Ω—å –¥–µ—Ä–µ–≤–∞
            const rootValue = Math.floor(Math.random() * 90) + 10;
            nodeCounter++;
            tree = new TreeNode(rootValue, containerWidth / 2, 80, 1, nodeCounter);
            
            // –°–ª—É—á–∞–π–Ω–æ –¥–æ–±–∞–≤–ª—è–µ–º —É–∑–ª—ã (–æ—Ç 3 –¥–æ 7 —É–∑–ª–æ–≤)
            const targetNodeCount = Math.floor(Math.random() * 5) + 3;
            let nodes = [tree];
            
            while (nodeCounter < targetNodeCount && nodes.length > 0) {
                // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π —É–∑–µ–ª –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö
                const randomIndex = Math.floor(Math.random() * nodes.length);
                const currentNode = nodes[randomIndex];
                
                // –†–µ—à–∞–µ–º, –¥–æ–±–∞–≤–ª—è—Ç—å –ª–∏ –ø–æ—Ç–æ–º–∫–∞
                if (Math.random() > 0.5 && !currentNode.left) {
                    const value = Math.floor(Math.random() * 90) + 10;
                    const xOffset = 180 / Math.pow(1.4, currentNode.level);
                    nodeCounter++;
                    
                    currentNode.left = new TreeNode(
                        value,
                        currentNode.x - xOffset,
                        currentNode.y + 100,
                        currentNode.level + 1,
                        nodeCounter
                    );
                    currentNode.left.parent = currentNode;
                    nodes.push(currentNode.left);
                }
                
                if (nodeCounter >= targetNodeCount) break;
                
                if (Math.random() > 0.5 && !currentNode.right) {
                    const value = Math.floor(Math.random() * 90) + 10;
                    const xOffset = 180 / Math.pow(1.4, currentNode.level);
                    nodeCounter++;
                    
                    currentNode.right = new TreeNode(
                        value,
                        currentNode.x + xOffset,
                        currentNode.y + 100,
                        currentNode.level + 1,
                        nodeCounter
                    );
                    currentNode.right.parent = currentNode;
                    nodes.push(currentNode.right);
                }
                
                // –£–¥–∞–ª—è–µ–º —É–∑–µ–ª, –µ—Å–ª–∏ —É –Ω–µ–≥–æ —É–∂–µ –¥–≤–∞ –ø–æ—Ç–æ–º–∫–∞
                if (currentNode.left && currentNode.right) {
                    nodes.splice(randomIndex, 1);
                }
            }
            
            selectNode(tree);
            updateTreeStats();
            renderTree();
            
            traversalInfo.textContent = `–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å–ª—É—á–∞–π–Ω–æ–µ –¥–µ—Ä–µ–≤–æ –∏–∑ ${nodeCounter} —É–∑–ª–æ–≤. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –æ–±—Ö–æ–¥–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ "–ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—Ö–æ–¥"`;
            traversalInfo.style.color = '#9b59b6';
        }
        
        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –¥–µ—Ä–µ–≤–∞
        function renderTree(activeNode = null) {
            treeVisualization.innerHTML = '';
            
            if (!tree) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ, –µ—Å–ª–∏ –¥–µ—Ä–µ–≤–æ –ø—É—Å—Ç–æ–µ
                const emptyMessage = document.createElement('div');
                emptyMessage.style.textAlign = 'center';
                emptyMessage.style.padding = '100px 20px';
                emptyMessage.style.color = '#7f8c8d';
                emptyMessage.innerHTML = `
                    <div style="font-size: 48px; margin-bottom: 20px;">üå≥</div>
                    <h3 style="margin-bottom: 10px;">–î–µ—Ä–µ–≤–æ –ø—É—Å—Ç–æ–µ</h3>
                    <p>–í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –Ω–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å –∫–æ—Ä–µ–Ω—å"</p>
                    <p style="font-size: 12px; margin-top: 20px;">–ò–ª–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å–ª—É—á–∞–π–Ω–æ–µ –¥–µ—Ä–µ–≤–æ</p>
                `;
                treeVisualization.appendChild(emptyMessage);
                return;
            }
            
            const treeContainer = document.createElement('div');
            treeContainer.className = 'tree';
            
            // –ù–∞—Ö–æ–¥–∏–º –≥—Ä–∞–Ω–∏—Ü—ã –¥–µ—Ä–µ–≤–∞ –¥–ª—è —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è
            let minX = Infinity, maxX = -Infinity, minY = Infinity, maxY = -Infinity;
            
            function calculateBounds(node) {
                if (!node) return;
                
                minX = Math.min(minX, node.x);
                maxX = Math.max(maxX, node.x);
                minY = Math.min(minY, node.y);
                maxY = Math.max(maxY, node.y);
                
                calculateBounds(node.left);
                calculateBounds(node.right);
            }
            
            calculateBounds(tree);
            
            // –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –¥–µ—Ä–µ–≤–æ
            const treeWidth = maxX - minX;
            const treeHeight = maxY - minY;
            const centerX = (treeVisualization.clientWidth - treeWidth) / 2 - minX;
            const centerY = 50; // –û—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É
            
            // –°–Ω–∞—á–∞–ª–∞ —Ä–∏—Å—É–µ–º –ª–∏–Ω–∏–∏
            function drawLines(node) {
                if (!node) return;
                
                // –õ–∏–Ω–∏—è –∫ –ª–µ–≤–æ–º—É –ø–æ—Ç–æ–º–∫—É
                if (node.left) {
                    const line = document.createElement('div');
                    line.className = 'tree-line';
                    
                    const startX = node.x + centerX;
                    const startY = node.y + centerY;
                    const endX = node.left.x + centerX;
                    const endY = node.left.y + centerY;
                    
                    const length = Math.sqrt(Math.pow(endX - startX, 2) + Math.pow(endY - startY, 2));
                    const angle = Math.atan2(endY - startY, endX - startX) * 180 / Math.PI;
                    
                    line.style.width = `${length}px`;
                    line.style.left = `${startX}px`;
                    line.style.top = `${startY}px`;
                    line.style.transform = `rotate(${angle}deg)`;
                    
                    treeContainer.appendChild(line);
                    drawLines(node.left);
                }
                
                // –õ–∏–Ω–∏—è –∫ –ø—Ä–∞–≤–æ–º—É –ø–æ—Ç–æ–º–∫—É
                if (node.right) {
                    const line = document.createElement('div');
                    line.className = 'tree-line';
                    
                    const startX = node.x + centerX;
                    const startY = node.y + centerY;
                    const endX = node.right.x + centerX;
                    const endY = node.right.y + centerY;
                    
                    const length = Math.sqrt(Math.pow(endX - startX, 2) + Math.pow(endY - startY, 2));
                    const angle = Math.atan2(endY - startY, endX - startX) * 180 / Math.PI;
                    
                    line.style.width = `${length}px`;
                    line.style.left = `${startX}px`;
                    line.style.top = `${startY}px`;
                    line.style.transform = `rotate(${angle}deg)`;
                    
                    treeContainer.appendChild(line);
                    drawLines(node.right);
                }
            }
            
            // –ó–∞—Ç–µ–º —Ä–∏—Å—É–µ–º —É–∑–ª—ã
            function drawNodes(node) {
                if (!node) return;
                
                const nodeElement = document.createElement('div');
                nodeElement.className = 'tree-node';
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–ª–∞—Å—Å—ã –¥–ª—è —É–∑–ª–∞
                if (node === tree) {
                    nodeElement.classList.add('root');
                }
                if (node === selectedNode) {
                    nodeElement.classList.add('selected');
                }
                if (traversalState.visited.includes(node)) {
                    nodeElement.classList.add('visited');
                }
                if (node === activeNode) {
                    nodeElement.classList.add('active');
                }
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ
                const displayX = node.x + centerX - 25; // 25 = –ø–æ–ª–æ–≤–∏–Ω–∞ —à–∏—Ä–∏–Ω—ã —É–∑–ª–∞
                const displayY = node.y + centerY - 25; // 25 = –ø–æ–ª–æ–≤–∏–Ω–∞ –≤—ã—Å–æ—Ç—ã —É–∑–ª–∞
                
                nodeElement.style.left = `${displayX}px`;
                nodeElement.style.top = `${displayY}px`;
                nodeElement.textContent = node.value;
                nodeElement.dataset.nodeId = node.id;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
                nodeElement.addEventListener('click', (e) => {
                    e.stopPropagation();
                    selectNode(node);
                });
                
                treeContainer.appendChild(nodeElement);
                
                // –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Ä–∏—Å—É–µ–º –ø–æ—Ç–æ–º–∫–æ–≤
                drawNodes(node.left);
                drawNodes(node.right);
            }
            
            drawLines(tree);
            drawNodes(tree);
            treeVisualization.appendChild(treeContainer);
        }
        
        // –û–±—Ö–æ–¥ –¥–µ—Ä–µ–≤–∞ –≤ –≥–ª—É–±–∏–Ω—É (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π)
        function* dfsTraversal(node, type = 'preorder') {
            if (!node) return;
            
            if (type === 'preorder') {
                yield node; // –ü–æ—Å–µ—Ç–∏—Ç—å —É–∑–µ–ª
                if (node.left) yield* dfsTraversal(node.left, type);
                if (node.right) yield* dfsTraversal(node.right, type);
            } else if (type === 'inorder') {
                if (node.left) yield* dfsTraversal(node.left, type);
                yield node; // –ü–æ—Å–µ—Ç–∏—Ç—å —É–∑–µ–ª
                if (node.right) yield* dfsTraversal(node.right, type);
            } else if (type === 'postorder') {
                if (node.left) yield* dfsTraversal(node.left, type);
                if (node.right) yield* dfsTraversal(node.right, type);
                yield node; // –ü–æ—Å–µ—Ç–∏—Ç—å —É–∑–µ–ª
            }
        }
        
        // –û–¥–∏–Ω —à–∞–≥ –æ–±—Ö–æ–¥–∞ –¥–µ—Ä–µ–≤–∞
        function traversalStep() {
            if (!traversalState.traversalStack || traversalState.currentStep >= traversalState.traversalStack.length) {
                traversalInfo.textContent = '‚úÖ –û–±—Ö–æ–¥ –¥–µ—Ä–µ–≤–∞ –∑–∞–≤–µ—Ä—à–µ–Ω!';
                traversalInfo.style.color = '#2ecc71';
                stopTraversal();
                return;
            }
            
            const currentNode = traversalState.traversalStack[traversalState.currentStep];
            traversalState.visited.push(currentNode);
            traversalState.order.push(currentNode.value);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
            const stepNumber = traversalState.currentStep + 1;
            const totalSteps = traversalState.traversalStack.length;
            visitedNodesElement.textContent = stepNumber;
            
            traversalInfo.textContent = `–®–∞–≥ ${stepNumber}/${totalSteps}: –ü–æ—Å–µ—â–∞–µ–º —É–∑–µ–ª ${currentNode.value}`;
            traversalInfo.style.color = '#3498db';
            
            traversalOrderElement.textContent = traversalState.order.join(' ‚Üí ');
            
            // –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –¥–µ—Ä–µ–≤–æ —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π
            renderTree(currentNode);
            
            traversalState.currentStep++;
        }
        
        // –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±—Ö–æ–¥–∞
        function startTraversal() {
            if (!tree) {
                alert('–°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ –¥–µ—Ä–µ–≤–æ');
                return;
            }
            
            if (traversalState.isRunning) return;
            
            // –ü–æ–ª—É—á–∞–µ–º —Ç–∏–ø –æ–±—Ö–æ–¥–∞
            const type = document.getElementById('traversalType').value;
            const typeNames = {
                'preorder': '–ü—Ä—è–º–æ–π –æ–±—Ö–æ–¥ (Pre-order)',
                'inorder': '–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –æ–±—Ö–æ–¥ (In-order)',
                'postorder': '–û–±—Ä–∞—Ç–Ω—ã–π –æ–±—Ö–æ–¥ (Post-order)'
            };
            
            // –°–æ–∑–¥–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –¥–ª—è –æ–±—Ö–æ–¥–∞
            const traversalGenerator = dfsTraversal(tree, type);
            
            // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≤ –º–∞—Å—Å–∏–≤ –¥–ª—è –ø–æ—à–∞–≥–æ–≤–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
            traversalState.traversalStack = [...traversalGenerator];
            traversalState.currentStep = 0;
            traversalState.visited = [];
            traversalState.order = [];
            traversalOrderElement.textContent = '';
            visitedNodesElement.textContent = '0';
            
            traversalState.isRunning = true;
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º
            const speed = parseInt(speedTraversalSelect.value);
            traversalState.intervalId = setInterval(() => {
                traversalStep();
            }, speed);
            
            traversalInfo.textContent = `üöÄ –ó–∞–ø—É—â–µ–Ω ${typeNames[type]}...`;
            traversalInfo.style.color = '#9b59b6';
        }
        
        // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±—Ö–æ–¥–∞
        function stopTraversal() {
            if (traversalState.intervalId) {
                clearInterval(traversalState.intervalId);
                traversalState.intervalId = null;
            }
            traversalState.isRunning = false;
        }
        
        // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–±—Ö–æ–¥–∞
        function resetTraversal() {
            stopTraversal();
            traversalState = {
                visited: [],
                order: [],
                currentStep: 0,
                isRunning: false,
                intervalId: null,
                traversalStack: []
            };
            traversalOrderElement.textContent = '';
            visitedNodesElement.textContent = '0';
            
            if (tree) {
                renderTree();
                traversalInfo.textContent = '–û–±—Ö–æ–¥ —Å–±—Ä–æ—à–µ–Ω. –í—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –¥–µ—Ä–µ–≤–æ –∏–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—Ö–æ–¥ —Å–Ω–æ–≤–∞';
                traversalInfo.style.color = '#7f8c8d';
            }
        }
        
        // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==========
        document.addEventListener('DOMContentLoaded', function() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∞—Å—Å–∏–≤–æ–º
            addNumberBtn.addEventListener('click', addSingleNumber);
            addMultipleBtn.addEventListener('click', addMultipleNumbers);
            clearArrayBtn.addEventListener('click', clearArray);
            generateRandomBtn.addEventListener('click', generateRandomArray);
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ Enter –≤ –ø–æ–ª—è—Ö –≤–≤–æ–¥–∞ –º–∞—Å—Å–∏–≤–∞
            singleNumberInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') addSingleNumber();
            });
            
            multipleNumbersInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') addMultipleNumbers();
            });
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–º –º–∞—Å—Å–∏–≤–∞
            decreaseSizeBtn.addEventListener('click', () => {
                updateArraySize(arraySize - 1);
            });
            
            increaseSizeBtn.addEventListener('click', () => {
                updateArraySize(arraySize + 1);
            });
            
            arraySizeSlider.addEventListener('input', function() {
                updateArraySize(parseInt(this.value));
            });
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
            document.getElementById('startSort').addEventListener('click', startSorting);
            document.getElementById('nextStepSort').addEventListener('click', () => {
                stopSorting();
                bubbleSortStep();
            });
            document.getElementById('resetSort').addEventListener('click', resetSorting);
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ –¥–µ—Ä–µ–≤–∞
            addRootBtn.addEventListener('click', addRoot);
            addLeftChildBtn.addEventListener('click', addLeftChild);
            addRightChildBtn.addEventListener('click', addRightChild);
            removeNodeBtn.addEventListener('click', removeNode);
            clearTreeBtn.addEventListener('click', clearTree);
            randomTreeBtn.addEventListener('click', generateRandomTree);
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ö–æ–¥–∞ –¥–µ—Ä–µ–≤–∞
            document.getElementById('startTraversal').addEventListener('click', startTraversal);
            document.getElementById('nextStepTraversal').addEventListener('click', () => {
                stopTraversal();
                traversalStep();
            });
            document.getElementById('resetTraversal').addEventListener('click', resetTraversal);
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            updateArrayStats();
            updateTreeStats();
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è Enter –≤ –ø–æ–ª—è—Ö –≤–≤–æ–¥–∞ –¥–µ—Ä–µ–≤–∞
            nodeValueInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') addRoot();
            });
            
            childValueInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    if (!addLeftChildBtn.disabled) addLeftChild();
                    else if (!addRightChildBtn.disabled) addRightChild();
                }
            });
            
            // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
            window.addEventListener('resize', function() {
                if (tree) {
                    renderTree();
                }
                if (array.length > 0) {
                    renderArray();
                }
            });
            
            // –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            sortInfo.textContent = '–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–∞ –≤ –º–∞—Å—Å–∏–≤ –∏–ª–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å–ª—É—á–∞–π–Ω—ã–π';
            traversalInfo.textContent = '–°–æ–∑–¥–∞–π—Ç–µ –¥–µ—Ä–µ–≤–æ –∏–ª–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å–ª—É—á–∞–π–Ω–æ–µ';
        });
    </script>
</body>
</html>